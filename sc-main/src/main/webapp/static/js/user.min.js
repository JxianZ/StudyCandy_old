/**
 * Created by toukajiang on 2017/3/28 0028.
 */

/******     reg-part1-function    ******/

function successCheck() {
    if (
        $("#inputusername").parent().parent().hasClass("has-success")
        &&$("#inputpassword").parent().parent().hasClass("has-success")
        &&$("#confirmpassword").parent().parent().hasClass("has-success")
        &&$("#inputemail").parent().parent().hasClass("has-success")
    )
    {
        $("#part1now").removeClass("disabled");
        $("#part1next").removeClass("disabled");
    }
}

$(function () {

    /* usernameinput*/

   $("#inputusername").blur(function () {
       if ($(this).val()!=""){
           var username=$(this).val();
           if (username.length<2){
                $(this).parent().parent().addClass("has-error");
                $("#usernamespan").html("用户名过短");
           }
           else if(username.length>=2){
               $(this).parent().parent().removeClass("has-error");
               $(this).parent().parent().removeClass("has-warning");
               $(this).parent().parent().addClass("has-success");
               $("#usernamespan").html("");
               successCheck();
           }
       }
       else if($("#usernamespan").html()!=""){
           $(this).parent().parent().removeClass("has-error");
           $(this).parent().parent().removeClass("has-success");
           $(this).parent().parent().addClass("has-warning");
           $("#usernamespan").html("");
       }
       else if($("#usernamespan").html()==""){
           $(this).parent().parent().removeClass("has-error");
           $(this).parent().parent().removeClass("has-success");
           $(this).parent().parent().removeClass("has-warning");
       }
   }) ; /* username end */

    /* passowrdinput */

    $("#inputpassword").blur(function () {
        if($(this).val()==""){
            $(this).parent().parent().removeClass("has-error");
            $(this).parent().parent().removeClass("has-success");
            $(this).parent().parent().removeClass("has-warning");
            $("#passwordspan").html("字母，数字或者英文符号，最短8位，区分大小写");
        }
        else {
            var passwordstr = /^[a-zA-Z0-9]+$/ ;
            if($("#confirmpassword").val()!=""){
                if(passwordstr.test($(this).val())&&$(this).val().length>8){
                    if($(this).val()==$("#confirmpassword").val()){
                        $(this).parent().parent().removeClass("has-error");
                        $(this).parent().parent().removeClass("has-warning");
                        $(this).parent().parent().addClass("has-success");
                        $("#passwordspan").html("");
                        $("#confirmpassword").parent().parent().removeClass("has-error");
                        $("#confirmpassword").parent().parent().removeClass("has-warning");
                        $("#confirmpassword").parent().parent().addClass("has-success");
                        $("#cfmpasswordspan").html("");
                        successCheck();
                    }
                    else{
                        $(this).parent().parent().removeClass("has-success");
                        $(this).parent().parent().removeClass("has-warning");
                        $(this).parent().parent().addClass("has-error");
                        $("#passwordspan").html("两次输入密码不一致");
                        $("#confirmpassword").parent().parent().removeClass("has-success");
                        $("#confirmpassword").parent().parent().removeClass("has-warning");
                        $("#confirmpassword").parent().parent().addClass("has-error");
                        $("#cfmpasswordspan").html("两次输入密码不一致");
                    }
                }
                else{
                    $(this).parent().parent().removeClass("has-success");
                    $(this).parent().parent().removeClass("has-warning");
                    $(this).parent().parent().addClass("has-error");
                    $("#passwordspan").html("密码格式不正确，不可使用大小写字母、数字以外的字符且大于8位");
                }
            }
            else if(!(passwordstr.test($(this).val())&&$(this).val().length>8)){
                $(this).parent().parent().removeClass("has-success");
                $(this).parent().parent().removeClass("has-warning");
                $(this).parent().parent().addClass("has-error");
                $("#passwordspan").html("密码只能由字母，数字组成且大于8位");
            }
            else if($("#inputpassword").val()!=""){
                $(this).parent().parent().removeClass("has-error");
                $(this).parent().parent().removeClass("has-warning");
                $(this).parent().parent().addClass("has-success");
                $("#passwordspan").html("");
            }
        }
    }); /* password end */

    $("#confirmpassword").blur(function () {
        if($(this).val()==""){
            $(this).parent().parent().removeClass("has-error");
            $(this).parent().parent().removeClass("has-success");
            $(this).parent().parent().removeClass("has-warning");
            $("#cfmpasswordspan").html("请再次输入密码");
        }
        else {
            var passwordstr = /^[a-zA-Z0-9]+$/ ;
            if($("#inputpassword").val()!=""){
                if(passwordstr.test($(this).val())&&$(this).val().length>8){
                    if($(this).val()==$("#inputpassword").val()){
                        $(this).parent().parent().removeClass("has-error");
                        $(this).parent().parent().removeClass("has-warning");
                        $(this).parent().parent().addClass("has-success");
                        $("#cfmpasswordspan").html("");
                        $("#inputpassword").parent().parent().removeClass("has-error");
                        $("#inputpassword").parent().parent().removeClass("has-warning");
                        $("#inputpassword").parent().parent().addClass("has-success");
                        $("#passwordspan").html("");
                        successCheck();
                    }
                    else{
                        $(this).parent().parent().removeClass("has-success");
                        $(this).parent().parent().removeClass("has-warning");
                        $(this).parent().parent().addClass("has-error");
                        $("#cfmpasswordspan").html("两次输入密码不一致");
                        $("#inputpassword").parent().parent().removeClass("has-success");
                        $("#inputpassword").parent().parent().removeClass("has-warning");
                        $("#inputpassword").parent().parent().addClass("has-error");
                        $("#passwordspan").html("两次输入密码不一致");
                    }
                }
                else{
                    $(this).parent().parent().removeClass("has-success");
                    $(this).parent().parent().removeClass("has-warning");
                    $(this).parent().parent().addClass("has-error");
                    $("#cfmpasswordspan").html("密码只能由字母，数字组成且大于8位");
                }
            }
            else if(!(passwordstr.test($(this).val())&&$(this).val().length>8)){
                $(this).parent().parent().removeClass("has-success");
                $(this).parent().parent().removeClass("has-warning");
                $(this).parent().parent().addClass("has-error");
                $("#cfmpasswordspan").html("密码只能由字母，数字组成且大于8位");
            }
            else if($("#confirmpassword").val()!=""){
                $(this).parent().parent().removeClass("has-error");
                $(this).parent().parent().removeClass("has-warning");
                $(this).parent().parent().addClass("has-success");
                $("#cfmpasswordspan").html("");
            }
        }
    });  /* password-cofirm end */

    /* email start */

    $("#inputemail").blur(function () {
        if($(this).val()==""){
            $(this).parent().parent().removeClass("has-error");
            $(this).parent().parent().removeClass("has-warning");
            $(this).parent().parent().removeClass("has-success");
            $("#emailspan").html("");
        }
        else{
            var emailstr=$("#inputemail").val();
            if(!emailstr.match(/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/)) {
                $(this).parent().parent().removeClass("has-success");
                $(this).parent().parent().removeClass("has-warning");
                $(this).parent().parent().addClass("has-error");
                $("#emailspan").html("邮箱格式不正确");
            }
            else{
                $(this).parent().parent().removeClass("has-error");
                $(this).parent().parent().removeClass("has-warning");
                $(this).parent().parent().addClass("has-success");
                $("#emailspan").html("");
                successCheck();
            }
        }
    });/* email end*/

    /****************   reg-now-start  ****************/

    $("#part1now").click(function () {
        if($(this).hasClass("disabled")){
            if(!$("#inputusername").parent().parent().hasClass("has-success")){
                $("#inputusername").parent().parent().addClass("has-warning");
            }
            if(!$("#inputpassword").parent().parent().hasClass("has-success")){
                $("#inputpassword").parent().parent().addClass("has-warning");
            }
            if(!$("#confirmpassword").parent().parent().hasClass("has-success")){
                $("#confirmpassword").parent().parent().addClass("has-warning");
            }
            if(!$("#inputemail").parent().parent().hasClass("has-success")){
                $("#inputemail").parent().parent().addClass("has-warning");
            }
            alert("请先完善信息");
        }
        else {
            /* TODO 验证码验证 */
            if(true){
                if($("#check-agree").is(':checked')){
                    /* TODO AJAX */
                    $("#reg-nav1").removeClass("reg-nav-on");
                    $("#reg-nav3").addClass("reg-nav-on");
                    $(".reg-part1").toggle();
                    $(".reg-part3").toggle();
                }
                else {
                    alert("您需同意我们的协议方可注册");
                }
            }
            else{
                alert("验证码错误");
                $("#codeinput").focus();
            }
        }
    }) ;

    /****************   reg-now-end  ****************/

});/* reg-part1-function end */

